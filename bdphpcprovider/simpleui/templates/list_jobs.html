{% extends "base.html" %}
{% block head %}
<meta http-equiv="refresh" content="60" >
{% endblock head %}

{% load split %}
{% load humanize %}
{% block content %}
<script type="text/javascript">
$(document).ready(function () {
           {% for job in object_list %}
           $('#{{ forloop.counter }}').tooltip();
           {% endfor %}
            $('.footable').footable();
       });
</script>
<div class="container">
<div class="row-fluid">
<h1> Jobs</h1>
</div>
<div class="row-fluid">
    <form class="form-horizontal" action="" method="POST"> {% csrf_token %}

    <table class="footable table table-hover table-bordered table-condensed">
        <thead>
            <tr>
            <th data-hide=""> <strong>JobID</strong>
            </th>
            <th data-hide="">
                <strong>Directive</strong>
            </th>
            <th data-hide="phone,tablet">
                <strong>Created</strong>
            </th>
            <th data-hide="phone">
                <strong>Iteration:State</strong>
            </th>
            <th data-hide=""></th>
            <th data-hide=""></th>
</tr>
        </thead>
        <tbody>
{% for job in object_list %}
<tr class='{{job.3|split:"0"}}'>
<td class="span1">{{ job.0 }} </td>
<td class="span2">{{ job.4 }} <a href="#" data-toggle="tooltip" tabindex="-1" data-placement="right" title="{{job.5}}" id='{{forloop.counter}}'><img src="#" class="icon-question-sign"></a>
</td>
<td class="span5">{{ job.2|date}} {{ job.2|time}} ({{job.2|naturaltime}})</td>

<td>
{% if job.3|split:"0" == 'error' %}
<img  class="icon-exclamation-sign">
{% endif %}
{{job.3|split:"1"}}
{% if job.1 %}
(job stopped)
{% endif %}

</td>
<td class="span2">
<div class="btn-group">
    <a href="{{ job.6 }}" class="btn btn-small" >Info</a>
</div>
<td class="">
    <div class="control-group">
  <label class="checkbox"><input id="delete_{{job.0}}"  type="checkbox" name="delete_{{job.0}}" class="checkbox" /></label>
</div>
</td>
</div>
</td>
</div>
</td>
</tr>
{% endfor %}
</tbody>
</table>
<div class="controls">
    <button type="submit" class="offset10 btn btn-small btn-warning">Terminate selected jobs</button>
</div>
</form>

<div class="pagination">
<div class="row-fluid">
    <ul>

        {% if offset <= 0  %}
        <li class="disabled"><span>&laquo</span></li>
        {% else %}
        <li><a href='{% url hrmcjob-list %}?offset={{ offset|add:"-20"}}'>&laquo;</a></li>
        {% endif %}

        {% for page_offset in page_offsets %}
        {% if page_offset == offset %}
        <li class="active">
        {% else %}
        <li>
       {% endif %}
       <a href='{% url hrmcjob-list %}?offset={{page_offset}}'>{{ forloop.counter}}</a></li>
        {% endfor %}

        {% if total_count <= offset|add:"20"  %}
        <li class="disabled"><span>&raquo</span></li>
        {% else %}
        <li><a href='{% url hrmcjob-list %}?offset={{ offset|add:"20"}}'>&raquo;</a></li>
        {% endif %}

</ul>
</div>
</div>
</div>
</div>
{% endblock %}

